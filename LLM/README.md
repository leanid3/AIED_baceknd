# Кастомная LLM модель для AIED системы

## Описание

Это простая реализация LLM API для интеграции с AIED backend системой. Модель предоставляет следующие возможности:

- Генерация DDL скриптов для PostgreSQL
- Анализ данных и генерация рекомендаций
- Обработка текстовых запросов
- Интеграция с существующими backend сервисами

## Возможности

### 1. Генерация DDL скриптов
- Анализ структуры данных из CSV
- Создание оптимизированных таблиц PostgreSQL
- Генерация индексов и ограничений
- Добавление комментариев к полям

### 2. Анализ данных
- Оценка качества данных
- Рекомендации по выбору хранилища
- Анализ структуры данных
- Генерация метаданных

### 3. Текстовые запросы
- Обработка естественных языковых запросов
- Генерация ответов на русском языке
- Контекстная обработка запросов

## API Endpoints

### POST /api/v1/process
Основной endpoint для обработки запросов.

**Формат запроса:**
```json
{
  "user_query": "Ваш запрос к LLM",
  "source_config": {
    "type": "text"
  },
  "target_config": {
    "type": "response"
  },
  "operation_type": "text_generation"
}
```

**Формат ответа:**
```json
{
  "pipeline_id": "pipeline_1234567890",
  "status": "success",
  "message": "Ответ от LLM",
  "error": null,
  "metadata": {
    "processing_time": 0.123,
    "model": "custom-llm-v1.0",
    "operation_type": "text_generation",
    "timestamp": "2024-01-01T12:00:00"
  }
}
```

### GET /health
Проверка здоровья сервиса.

### GET /api/v1/models
Список доступных моделей.

### GET /api/v1/status
Статус сервиса.

## Типы операций

- `text_generation` - Генерация текстовых ответов
- `ddl_generation` - Генерация DDL скриптов
- `data_analysis` - Анализ данных

## Запуск

### Локальный запуск
```bash
cd LLM
pip install -r requirements.txt
python app.py
```

### Docker
```bash
cd LLM
docker build -t custom-llm .
docker run -p 8124:8124 custom-llm
```

### Переменные окружения
- `PORT` - Порт для запуска (по умолчанию 8124)
- `DEBUG` - Режим отладки (true/false)

## Интеграция с AIED системой

Модель автоматически интегрируется с существующими сервисами:

1. **API Gateway** - использует `/api/v1/process` для маршрутизации запросов
2. **LLM Service** - обрабатывает запросы через `CustomLLMClient`
3. **Data Analysis Service** - использует модель для анализа данных и генерации DDL

## Логирование

Сервис ведет подробные логи всех операций:
- Время обработки запросов
- Типы операций
- Ошибки и исключения
- Метаданные запросов

## Безопасность

- Запуск под непривилегированным пользователем
- Валидация входных данных
- Обработка ошибок
- CORS поддержка для веб-интерфейса
