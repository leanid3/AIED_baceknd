# üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ workflow

## üìã –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### 1. **–ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã**
```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
./start.sh start

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
./start.sh status

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã
./check-system.sh
```

### 2. **–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ —á–µ—Ä–µ–∑ API Gateway**

#### CSV —Ñ–∞–π–ª (332MB)
```bash
curl -X POST http://localhost:8080/v1/files/upload/csv \
  -H "Content-Type: multipart/form-data" \
  -F "file=@_data/csv/part-00000-37dced01-2ad2-48c8-a56d-54b4d8760599-c000.csv" \
  -F "user_id=test-user-1"
```

#### JSON —Ñ–∞–π–ª (415MB)
```bash
curl -X POST http://localhost:8080/v1/files/upload/json \
  -H "Content-Type: multipart/form-data" \
  -F "file=@_data/json/part1.json" \
  -F "user_id=test-user-2"
```

#### XML —Ñ–∞–π–ª (937MB)
```bash
curl -X POST http://localhost:8080/v1/files/upload/xml \
  -H "Content-Type: multipart/form-data" \
  -F "file=@_data/xml/part1.xml" \
  -F "user_id=test-user-3"
```

### 3. **–°–æ–∑–¥–∞–Ω–∏–µ –¥–∏–∞–ª–æ–≥–∞ –≤ Chat Service**

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏–∞–ª–æ–≥–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ CSV
curl -X POST http://localhost:8080/v1/dialogs \
  -H "Content-Type: application/json" \
  -d '{
    "user_id": "test-user-1",
    "title": "–ê–Ω–∞–ª–∏–∑ CSV –¥–∞–Ω–Ω—ã—Ö",
    "initial_message": "–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–π CSV —Ñ–∞–π–ª"
  }'

# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏–∞–ª–æ–≥–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ JSON
curl -X POST http://localhost:8080/v1/dialogs \
  -H "Content-Type: application/json" \
  -d '{
    "user_id": "test-user-2",
    "title": "–ê–Ω–∞–ª–∏–∑ JSON –¥–∞–Ω–Ω—ã—Ö",
    "initial_message": "–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–π JSON —Ñ–∞–π–ª"
  }'

# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏–∞–ª–æ–≥–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ XML
curl -X POST http://localhost:8080/v1/dialogs \
  -H "Content-Type: application/json" \
  -d '{
    "user_id": "test-user-3",
    "title": "–ê–Ω–∞–ª–∏–∑ XML –¥–∞–Ω–Ω—ã—Ö",
    "initial_message": "–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–π XML —Ñ–∞–π–ª"
  }'
```

### 4. **–°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–∞ –∞–Ω–∞–ª–∏–∑–∞**

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–∞ –¥–ª—è CSV
curl -X POST http://localhost:8080/v1/pipelines \
  -H "Content-Type: application/json" \
  -d '{
    "source": {
      "type": {
        "file": {
          "format": "csv",
          "url": "users/test-user-1/[file_id]/part-00000-37dced01-2ad2-48c8-a56d-54b4d8760599-c000.csv"
        }
      }
    },
    "target": {
      "type": "postgres",
      "table_name": "analyzed_data"
    },
    "user_id": "test-user-1",
    "file_id": "[file_id_from_upload]"
  }'

# –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–∞ –¥–ª—è JSON
curl -X POST http://localhost:8080/v1/pipelines \
  -H "Content-Type: application/json" \
  -d '{
    "source": {
      "type": {
        "file": {
          "format": "json",
          "url": "users/test-user-2/[file_id]/part1.json"
        }
      }
    },
    "target": {
      "type": "clickhouse",
      "table_name": "json_data"
    },
    "user_id": "test-user-2",
    "file_id": "[file_id_from_upload]"
  }'

# –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–∞ –¥–ª—è XML
curl -X POST http://localhost:8080/v1/pipelines \
  -H "Content-Type: application/json" \
  -d '{
    "source": {
      "type": {
        "file": {
          "format": "xml",
          "url": "users/test-user-3/[file_id]/part1.xml"
        }
      }
    },
    "target": {
      "type": "hdfs",
      "table_name": "/data/xml_processed"
    },
    "user_id": "test-user-3",
    "file_id": "[file_id_from_upload]"
  }'
```

### 5. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞
curl -X GET http://localhost:8080/v1/pipelines/[pipeline_id]

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ DAG –≤ Airflow
curl -X GET http://localhost:8082/api/v1/dags/data_analysis_test-user-1

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
docker-compose logs -f orchestration-service
```

### 6. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**

```bash
# –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ñ–∞–π–ª–µ
curl -X GET http://localhost:8080/v1/files/[file_id]?user_id=test-user-1

# –ü–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –¥–∏–∞–ª–æ–≥–∞
curl -X GET http://localhost:8080/v1/dialogs/[dialog_id]/messages?user_id=test-user-1

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ Airflow
curl -X GET http://localhost:8082/api/v1/dags/data_analysis_test-user-1/dagRuns
```

## üîç –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### 1. **–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤**
- ‚úÖ –§–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ MinIO
- ‚úÖ –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ PostgreSQL
- ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è file_id –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 2. **–°–æ–∑–¥–∞–Ω–∏–µ –¥–∏–∞–ª–æ–≥–æ–≤**
- ‚úÖ –î–∏–∞–ª–æ–≥–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ Chat Service
- ‚úÖ –°–æ–æ–±—â–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è dialog_id

### 3. **–°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–æ–≤**
- ‚úÖ DAG —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤ Airflow
- ‚úÖ –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–Ω–∞–ª–∏–∑ —á–µ—Ä–µ–∑ LLM Service
- ‚úÖ –ì–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –¥–∞–Ω–Ω—ã—Ö

### 4. **–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–∞**
- ‚úÖ LLM –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ì–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è DDL —Å–∫—Ä–∏–ø—Ç—ã
- ‚úÖ –°–æ–∑–¥–∞—é—Ç—Å—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### 5. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**
- ‚úÖ –°—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ Chat Service
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞
- ‚úÖ –°–æ–∑–¥–∞—é—Ç—Å—è –æ—Ç—á–µ—Ç—ã –ø–æ –∫–∞—á–µ—Å—Ç–≤—É –¥–∞–Ω–Ω—ã—Ö

## üö® –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞: –§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π
**–†–µ—à–µ–Ω–∏–µ**: –£–≤–µ–ª–∏—á–∏—Ç—å –ª–∏–º–∏—Ç—ã gRPC –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –ü—Ä–æ–±–ª–µ–º–∞: LLM –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç
**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å Ollama –∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å –º–æ–¥–µ–ª—å

### –ü—Ä–æ–±–ª–µ–º–∞: Airflow –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç DAG
**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Airflow –∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

### –ü—Ä–æ–±–ª–µ–º–∞: MinIO –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å MinIO –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞: < 30 —Å–µ–∫—É–Ω–¥
- –ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã: < 2 –º–∏–Ω—É—Ç
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è DDL: < 1 –º–∏–Ω—É—Ç—ã
- –°–æ–∑–¥–∞–Ω–∏–µ DAG: < 10 —Å–µ–∫—É–Ω–¥

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
- –ü–∞–º—è—Ç—å: < 2GB –Ω–∞ —Å–µ—Ä–≤–∏—Å
- CPU: < 50% –Ω–∞ —Å–µ—Ä–≤–∏—Å
- –î–∏—Å–∫: < 1GB –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

### –ö–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö
- –¢–æ—á–Ω–æ—Å—Ç—å –∞–Ω–∞–ª–∏–∑–∞: > 90%
- –ü–æ–ª–Ω–æ—Ç–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π: > 80%
- –í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ API: < 5 —Å–µ–∫—É–Ω–¥

## üîß –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
./check-system.sh

# –õ–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker-compose logs -f file-service
docker-compose logs -f chat-service
docker-compose logs -f llm-service
docker-compose logs -f orchestration-service

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
docker-compose exec api-gateway ping file-service
docker-compose exec api-gateway ping chat-service

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
docker-compose exec postgres psql -U testuser -d testdb -c "SELECT * FROM files LIMIT 5;"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ MinIO
docker-compose exec minio mc ls minio/files
```

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö:
- **File Service**: –ó–∞–≥—Ä—É–∑–∫–∞, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
- **Chat Service**: –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏–∞–ª–æ–≥–æ–≤, –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
- **LLM Service**: –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
- **Orchestration Service**: –°–æ–∑–¥–∞–Ω–∏–µ DAG, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

## üéØ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

1. ‚úÖ –í—Å–µ —Ñ–∞–π–ª—ã —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è
2. ‚úÖ –î–∏–∞–ª–æ–≥–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –∏ —Ä–∞–±–æ—Ç–∞—é—Ç
3. ‚úÖ –ü–∞–π–ø–ª–∞–π–Ω—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ Airflow
4. ‚úÖ LLM –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ
5. ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
6. ‚úÖ –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π